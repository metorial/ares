model UserIdentityProvider {
  oid BigInt @id
  id  String @unique

  name String

  oauthProviderOid BigInt?          @unique
  oauthProvider    AppOAuthProvider? @relation(fields: [oauthProviderOid], references: [oid], onDelete: SetNull)

  ssoTenantOid BigInt?    @unique
  ssoTenant    SsoTenant? @relation(fields: [ssoTenantOid], references: [oid], onDelete: SetNull)

  createdAt DateTime @default(now())

  UserIdentity UserIdentity[]
}

model UserIdentity {
  oid BigInt @id
  id  String @unique

  providerOid BigInt
  provider    UserIdentityProvider @relation(fields: [providerOid], references: [oid], onDelete: Cascade)

  userOid BigInt?
  user    User?   @relation(fields: [userOid], references: [oid], onDelete: Cascade)

  uid       String
  name      String
  firstName String
  lastName  String
  email     String
  photoUrl  String?

  ssoUserProfileOid BigInt?
  ssoUserProfile    SsoUserProfile? @relation(fields: [ssoUserProfileOid], references: [oid], onDelete: SetNull)

  createdAt DateTime @default(now())
  updatedAt DateTime @default(now()) @updatedAt

  authIntents AuthIntent[]

  @@index([providerOid, uid])
}
